<!DOCTYPE html>
<html lang="vi">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="/src/services/auth-guard.min.js"></script>
    <!-- Auth check will be handled by JavaScript at bottom of page -->

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <!-- Perf hints -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>

    <!-- Theme colors -->
    <meta name="theme-color" content="#b71c1c">
    <meta name="msapplication-navbutton-color" content="#b71c1c">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <!-- Apple PWA Settings -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="eTax Mobile">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/logo.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/logo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/logo.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/assets/logo.png">

    <!-- Splash Screen Images cho iOS (ch·ªâ b·∫≠t khi c√≥ file th·∫≠t) -->
    <!-- ƒê√£ t·∫°m th·ªùi g·ª° v√¨ thi·∫øu assets/splash-*.png ƒë·ªÉ tr√°nh 404 -->

    <!-- Microsoft PWA -->
    <meta name="msapplication-starturl" content="./index.html">
    <meta name="msapplication-TileColor" content="#b71c1c">
    <meta name="msapplication-TileImage" content="/assets/logo.png">

    <!-- T·∫Øt s·ªë ƒëi·ªán tho·∫°i t·ª± ƒë·ªông link -->
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="email=no">
    <meta name="format-detection" content="address=no">

    <!-- Security headers -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">


    <title>eTax Mobile - Home (v20250720-2)</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="css/home.css" />
    <!-- Theme System CSS -->
    <link rel="stylesheet" href="css/user-interface-manager.css" />
    <!-- UI utilities for icon sizing -->
    <link rel="stylesheet" href="css/pwa-optimizations.css" />

    <!-- Th∆∞ vi·ªán Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

    <!-- Theme System Scripts -->
    <script src="src/services/theme-manager.js"></script>
    <script src="src/services/user-interface-manager.js"></script>
    <script src="src/services/placeholder-system.js"></script>

    <style>
      /* ‚úÖ NATIVE APP - C·ªê ƒê·ªäNH M√ÄN H√åNH NH∆Ø APP MOBILE TH·∫¨T */
      /* Reset v√† chu·∫©n h√≥a to√†n b·ªô giao di·ªán */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', 'Tahoma', 'Microsoft Sans Serif', 'Arial', sans-serif;
        touch-action: manipulation;
        -webkit-overflow-scrolling: touch;
        -webkit-tap-highlight-color: transparent;
      }

      html {
        margin: 0 !important;
        padding: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        background: #000 !important;
        box-sizing: border-box;
        /* ‚úÖ CHO PH√âP SCROLL - HTML LEVEL */
        overflow: visible;
        overscroll-behavior: none !important;
        -webkit-overscroll-behavior: none !important;
        overscroll-behavior-x: none !important;
        overscroll-behavior-y: none !important;
        /* ‚úÖ CHO PH√âP TOUCH C∆† B·∫¢N */
        touch-action: pan-y;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
        /* üîí KH√ìA ZOOM */
        -webkit-text-size-adjust: 100% !important;
        -ms-text-size-adjust: 100% !important;
      }

      body {
        margin: 0 !important;
        padding: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        background: #000 !important;
        box-sizing: border-box;
        /* ‚úÖ CHO PH√âP SCROLL - BODY C·∫¶N SCROLL */
        overflow: visible;
        overscroll-behavior: none !important;
        -webkit-overscroll-behavior: none !important;
        overscroll-behavior-x: none !important;
        overscroll-behavior-y: none !important;
        /* ‚úÖ CHO PH√âP SCROLL V√Ä TOUCH C∆† B·∫¢N */
        touch-action: pan-y;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
        /* üîí PWA Safe Area */
        padding-top: env(safe-area-inset-top, 0px);
        padding-bottom: env(safe-area-inset-bottom, 0px);
        padding-left: env(safe-area-inset-left, 0px);
        padding-right: env(safe-area-inset-right, 0px);
        /* üîí C·ªê ƒê·ªäNH LAYOUT */
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        position: relative;
      }

      /* ‚úÖ BODY ƒê√É ƒê∆Ø·ª¢C ƒê·ªäNH NGHƒ®A ·ªû TR√äN - B·ªé DUPLICATE */

      .phone-frame {
        width: 100vw;
        height: 100vh !important;
        /* ‚úÖ C·ªê ƒê·ªäNH CHI·ªÄU CAO = VIEWPORT */
        background-image: url('assets/nen.png');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center center;
        border-radius: 0;
        box-shadow: none;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: stretch;
        /* ‚úÖ NATIVE APP CONTAINER - CHO PH√âP SCROLL */
        overflow: visible;
        position: relative;
        /* ‚úÖ S·ª¨A L·∫†I POSITION */
      }

      @media (min-width: 601px) {
        .phone-frame {
          border-radius: 30px;
          margin: 32px auto;
          box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
          width: 400px;
        }
      }

      /* ‚úÖ TOPBAR - ADJUSTED TO LOGO TEXT BOTTOM AS REQUESTED */
      .topbar {
        position: fixed;
        /* ‚úÖ FIXED POSITION FOR NATIVE APP FEEL */
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background-color: #b71c1c;
        /* üî¥ CHANGED TO #b71c1c AS REQUESTED */
        color: white;
        padding: 12px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 95px;
        /* ‚úÖ REDUCED TO ALIGN WITH LOGO TEXT BOTTOM */
        /* üîí PWA Safe Area */
        padding-top: max(12px, env(safe-area-inset-top));
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      /* V·ªä TR√ç A: Menu burger b√™n tr√°i - ƒë√£ ƒë√∫ng */
      .left-menu {
        font-size: 24px;
        color: white;
        padding-left: 10px;
        cursor: pointer;
      }

      /* V·ªä TR√ç GI·ªÆA: Logo + text - di chuy·ªÉn sang ph·∫£i v√† xu·ªëng th·∫•p */
      .center-logo {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        flex-grow: 1;
        text-align: center;
        margin-left: 30px;
        /* üîß Di chuy·ªÉn sang ph·∫£i */
        margin-top: 15px;
        /* üîß Di chuy·ªÉn xu·ªëng th·∫•p */
      }

      .center-logo img {
        height: 45px;
        margin-bottom: 6px;
      }

      .center-logo span {
        font-weight: bold;
        font-size: 17px;
        letter-spacing: 0.5px;
      }

      /* V·ªä TR√ç B: QR + Bell icons b√™n ph·∫£i - ch·ªânh th·∫≥ng h√†ng */
      .right-icon {
        display: flex;
        align-items: center;
        gap: 10px;
        padding-right: 10px;
      }

      .right-icon img {
        height: 24px;
      }

      .user-info {
        background-image: url('assets/backgrounftd.png');
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        padding: 18px;
        margin: 6px 16px;
        /* üîß Gi·∫£m margin top/bottom t·ª´ 12px ‚Üí 6px */
        border-radius: 15px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
      }

      .avatar {
        height: 52px;
        width: 52px;
        border-radius: 50%;
        margin-right: 18px;
        border: 2px solid rgba(255, 255, 255, 0.3);
      }

      .userinfo-text .mst {
        font-size: 14px;
        color: #333;
        font-weight: 500;
      }

      .userinfo-text .username {
        font-size: 18px;
        font-weight: bold;
        color: #a40000;
        margin-top: 2px;
      }

      .quick-actions,
      .group-services {
        margin: 4px 16px;
        /* üîß Gi·∫£m t·ª´ 8px ‚Üí 4px ƒë·ªÉ d·ªìn g·∫ßn nhau */
      }

      h3 {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 8px;
        /* üîß Gi·∫£m t·ª´ 12px ‚Üí 8px */
        color: white;
      }

      .scroll-row {
        display: flex;
        overflow-x: auto;
        gap: 12px;
      }

      .circle-item {
        background-color: #a40000;
        color: white;
        padding: 12px;
        border-radius: 50%;
        min-width: 80px;
        min-height: 80px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        text-align: center;
        word-break: break-word;
        white-space: normal;
      }

      .grid-box {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }

      .grid-item {
        background-color: white;
        border-radius: 12px;
        padding: 14px 8px;
        text-align: center;
        font-size: 12px;
        color: #000;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        transition: transform 0.2s ease;
        cursor: pointer;
        min-height: 85px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .grid-item:hover {
        transform: scale(1.02);
      }

      .grid-item img {
        width: 48px;
        height: 48px;
        margin-bottom: 6px;
        object-fit: contain;
      }

      /* Slide menu - Clone app g·ªëc 870x1883 */
      .slide-menu {
        position: fixed;
        top: 0;
        left: -320px;
        width: 320px;
        /* üîß TƒÉng width gi·ªëng app g·ªëc */
        height: 100vh;
        background: white;
        z-index: 9999;
        transition: none;
        /* üîß B·ªè transition ƒë·ªÉ m∆∞·ª£t h∆°n */
        overflow-y: hidden;
        /* üîß ·∫®n scroll bar ch√≠nh */
        box-shadow: 2px 0 12px rgba(0, 0, 0, 0.3);
        /* üîß Shadow ƒë·∫≠m h∆°n */
      }

      .slide-menu.open {
        left: 0;
      }

      .slide-header {
        background-image: url('assets/back.png');
        background-size: cover;
        background-repeat: no-repeat;
        color: white;
        text-align: center;
        padding: 20px 0;
        /* üîß Full width padding */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        /* üîß Full width */
        /* üîí PWA Safe Area */
        padding-top: max(20px, env(safe-area-inset-top));
      }

      .slide-header .logo {
        width: 160px;
        /* üîß Gi·∫£m k√≠ch th∆∞·ªõc ƒë·ªÉ g·ªçn h∆°n */
        height: 160px;
        margin-bottom: 12px;
        object-fit: contain;
      }

      /* üîß Th√™m greeting box full width */
      .slide-greeting {
        background-color: #b71c1c;
        color: white;
        padding: 16px 20px;
        text-align: left;
        font-size: 18px;
        font-weight: bold;
        border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        width: 100%;
      }

      .slide-links {
        display: flex;
        flex-direction: column;
        padding: 0;
        /* üîß B·ªè padding ƒë·ªÉ scroll items t·ª± handle */
        height: calc(100vh - 280px);
        /* üîß Chi·ªÅu cao ch√≠nh x√°c */
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }

      .slide-links a {
        text-decoration: none;
        color: #333;
        padding: 16px 20px;
        /* üîß Padding r·ªông h∆°n nh∆∞ app g·ªëc */
        font-size: 16px;
        /* üîß Font size l·ªõn h∆°n */
        display: flex;
        align-items: center;
        border-bottom: 1px solid #f0f0f0;
        /* üîß Th√™m border gi·ªØa items */
        transition: none;
        /* üîß B·ªè transition */
      }

      .slide-links a:hover {
        background-color: #f5f5f5;
        /* üîß Hover effect nh·∫π */
      }

      .slide-links a img {
        width: 32px;
        /* üîß Icon size chu·∫©n */
        height: 32px;
        margin-right: 16px;
        /* üîß Spacing gi·ªØa icon v√† text */
        object-fit: contain;
      }

      .slide-links a:last-child {
        color: #d62828 !important;
        /* üîß M√†u ƒë·ªè cho ƒëƒÉng xu·∫•t */
        font-weight: bold;
        border-top: 2px solid #f0f0f0;
        margin-top: 8px;
      }

      /* üîß Scroll optimization cho slide-links */
      .slide-links::-webkit-scrollbar {
        display: none;
      }

      .slide-links {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* üîß Menu overlay backdrop */
      .menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9998;
        display: none;
      }

      .menu-overlay.show {
        display: block;
      }

      /* N√∫t ƒëƒÉng nh·∫≠p */
      .btn-login {
        width: 100%;
        max-width: 340px;
        margin: 0 auto;
        display: block;
      }

      .content-scrollable {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 10px;
        gap: 0;
        /* ‚úÖ B·ªé SCROLL - CH·ªà L√Ä CONTAINER */
        overflow: hidden;
        /* üîí KH√ìA TRI·ªÜT ƒê·ªÇ OVERSCROLL */
        overscroll-behavior: none !important;
        -webkit-overscroll-behavior: none !important;
        overscroll-behavior-x: none !important;
        overscroll-behavior-y: none !important;
        /* üîí CH·ªà CHO PH√âP SCROLL D·ªåC TRONG CONTENT */
        touch-action: pan-y !important;
        -webkit-overflow-scrolling: touch;
        position: relative;
        /* ‚úÖ FLEXBOX T·ª∞ NHI√äN - CHO PH√âP EXPAND */
        /* B·ªè t·∫•t c·∫£ height c·ªë ƒë·ªãnh ƒë·ªÉ flex-grow ho·∫°t ƒë·ªông */
      }

      .content-scrollable::-webkit-scrollbar {
        display: none;
      }

      /* ‚úÖ ·∫®N SCROLLBAR HO√ÄN TO√ÄN CHO T·∫§T C·∫¢ ELEMENTS */
      .scrollable-content::-webkit-scrollbar {
        display: none;
      }

      .scrollable-content {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      .main-content-wrapper::-webkit-scrollbar {
        display: none;
      }

      .main-content-wrapper {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* ‚úÖ PERFORMANCE OPTIMIZATION - B·ªè t·∫•t c·∫£ animation */
      *,
      *::before,
      *::after {
        animation-duration: 0s !important;
        animation-delay: 0s !important;
        transition-duration: 0s !important;
        transition-delay: 0s !important;
        transform: none !important;
      }

      /* ‚úÖ PWA Native App Appearance */
      @supports (-webkit-touch-callout: none) {
        .phone-frame {
          user-select: none;
          -webkit-touch-callout: none;
          -webkit-user-select: none;
          -webkit-tap-highlight-color: transparent;
        }
      }

      .login-form,
      .container {
        width: 100%;
        max-width: 340px;
        margin: 0 auto;
      }

      /* Section danh s√°ch nh√≥m d·ªãch v·ª• - PWA Single Screen */
      .service-grid-section {
        background: #ffffff;
        padding: 15px;
        margin: 6px 12px 20px 12px;
        /* ƒê√£ th√™m margin-bottom */
        border-radius: 14px 14px 0 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);

        /* üéØ AUTO HEIGHT: ƒê·ªÉ content t·ª± quy·∫øt ƒë·ªãnh chi·ªÅu cao */
        /* height: calc(100vh - 530px); - B·ªé C·ªê ƒê·ªäNH */
        /* min-height: 400px; - ƒê√£ x√≥a ƒë·ªÉ section co l·∫°i */
        /* max-height: 400px; - B·ªé GI·ªöI H·∫†N ƒë·ªÉ scroll ƒë∆∞·ª£c */
        display: flex;
        flex-direction: column;

        /* ƒê·∫£m b·∫£o c√≥ padding-bottom ƒë·ªÉ kh√¥ng s√°t m√©p */
        padding-bottom: 15px;
        /* ƒê√£ gi·∫£m padding-bottom */

        /* Responsive cho c√°c thi·∫øt b·ªã kh√°c nhau */
        overflow: hidden;
        /* B·ªè scroll ri√™ng c·ªßa section */
      }

      .service-grid-section h3 {
        margin-bottom: 16px;
        font-size: 18px;
        color: black;
      }

      /* L∆∞·ªõi ch·ª©a c√°c icon d·ªãch v·ª• */
      .grid-box {
        display: grid;
        /* T·ª± ƒë·ªông chia 3 c·ªôt ƒë·ªÅu nhau */
        grid-template-columns: repeat(3, 1fr);
        /* Kho·∫£ng c√°ch gi·ªØa c√°c icon */
        gap: 16px;
        padding-top: 15px;
      }

      .grid-item {
        text-align: center;
        cursor: pointer;
      }

      .grid-item .icon-background {
        background: white;
        border-radius: 10px;
        padding: 6px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        display: inline-block;
        margin-bottom: 8px;
      }

      .grid-item img {
        width: 48px;
        height: 48px;
        display: block;
      }

      .grid-item span {
        display: block;
        font-size: 15px;
        font-weight: 500;
        line-height: 1.3;
        color: #000;
      }
    </style>

    <script>
      // ƒêƒÉng k√Ω Service Worker
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function () {
          navigator.serviceWorker.register('/service-worker.js')
            .then(function (registration) {
              console.log('‚úÖ ServiceWorker registered successfully');
            })
            .catch(function (error) {
              console.log('‚ùå ServiceWorker registration failed');
            });
        });
      }

    </script>
    <script>

      // T·∫Øt context menu
      document.addEventListener('contextmenu', function (e) {
        e.preventDefault();
      });

      // T·∫Øt drag
      document.addEventListener('dragstart', function (e) {
        e.preventDefault();
      });

      // Kh·∫Øc ph·ª•c iOS Safari swipe back
      document.addEventListener('touchstart', function (e) {
        if (e.touches.length > 1) {
          e.preventDefault();
        }
      });

      let lastTouchEnd = 0;
      document.addEventListener('touchend', function (e) {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
          e.preventDefault();
        }
        lastTouchEnd = now;
      }, false);

      // Kh·∫Øc ph·ª•c double tap zoom
      let lastTouchTime = 0;
      document.addEventListener('touchstart', function (e) {
        const now = Date.now();
        if (now - lastTouchTime <= 500) {
          e.preventDefault();
        }
        lastTouchTime = now;
      });

      // T·∫Øt pull to refresh
      let startY = 0;
      document.addEventListener('touchstart', function (e) {
        startY = e.touches[0].clientY;
      });

      document.addEventListener('touchmove', function (e) {
        const y = e.touches[0].clientY;
        if (startY <= 10 && y > startY) {
          e.preventDefault();
        }
      });

      // Kh·∫Øc ph·ª•c viewport height cho mobile
      function setViewportHeight() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', vh + 'px');
      }

      window.addEventListener('resize', setViewportHeight);
      window.addEventListener('orientationchange', function () {
        setTimeout(setViewportHeight, 500);
      });
      setViewportHeight();

      // Orientation lock warning
      function checkOrientation() {
        if (window.innerHeight < 500 && window.innerWidth > window.innerHeight) {
          document.body.classList.add('landscape-mode');
        } else {
          document.body.classList.remove('landscape-mode');
        }
      }

      window.addEventListener('orientationchange', function () {
        setTimeout(checkOrientation, 500);
      });
      window.addEventListener('resize', checkOrientation);
      checkOrientation();

      // ===== THEME SYSTEM INITIALIZATION =====
      async function initializeThemeSystem() {
        try {
          console.log('üé® Initializing Theme System in index.html...');

          // Check if user is logged in
          const loggedInUser = localStorage.getItem('etax_logged_in_user');
          const userData = JSON.parse(localStorage.getItem('etax_user') || '{}');

          if (!loggedInUser) {
            console.log('‚ö†Ô∏è No user logged in, redirecting to login...');
            window.location.href = '/login.html';
            return;
          }

          // Wait for theme manager to be available
          if (window.themeManager) {
            // Determine theme based on user data
            let theme = 'corporate'; // default

            if (userData.preferredTheme) {
              theme = userData.preferredTheme;
            } else if (userData.userType) {
              theme = userData.userType;
            } else if (userData.businessType) {
              const businessType = userData.businessType.toLowerCase();
              if (businessType.includes('dnnv') || businessType.includes('nh√† n∆∞·ªõc')) {
                theme = 'government';
              } else if (businessType.includes('hkd') || businessType.includes('c√° nh√¢n')) {
                theme = 'individual';
              }
            }

            // Apply theme
            await window.themeManager.applyTheme(theme, userData);
            console.log(`‚úÖ Applied theme: ${theme} for user: ${userData.fullName || loggedInUser}`);
          }

          // Initialize UI Manager
          if (window.uiManager && !window.uiManager.isInitialized) {
            await window.uiManager.initialize();
            console.log('‚úÖ UI Manager initialized');
          }

        } catch (error) {
          console.error('‚ùå Error initializing theme system:', error);
        }
      }

    </script>

    <!-- CSS cho orientation warning -->
    <style>
      .landscape-mode .orientation-warning {
        display: flex !important;
      }


      .landscape-mode .phone-frame,
      .landscape-mode .app-container,
      .landscape-mode .main-container {
        display: none !important;
      }
    </style>

  </head>

  <body>

    <div class="phone-frame">
      <div id="slideMenu" class="slide-menu">
        <div class="slide-header"
          style="height: 327px; position: relative; background-color: #b71c1c; background-image: url('assets/slidebg.png'); background-size: cover; background-position: center; padding: 37px 0 15px 0; display: flex; flex-direction: column; justify-content: flex-start; align-items: center;">
          <img src="assets/logo.png" class="logo"
            style="width: 130px; height: 130px; margin-bottom: 15px; margin-top: 20px;" />
          <div class="slide-greeting"
            style="background: rgba(216,14,4,1); color: white; padding: 12px 20px; text-align: left; font-size: 22px; font-weight: 600; line-height: 1.3; box-shadow: inset 0 2px 4px rgba(255,255,255,0.2), 0 1px 3px rgba(0,0,0,0.3); width: 100%; margin: 0 0 15px 0;">
            <div>Xin ch√†o Nguy·ªÖn Trung</div>
            <div style="font-size: 24px; font-weight: bold; margin-top: 5px;">Nghƒ©a</div>
          </div>
        </div>
        <div class="slide-links" style="padding: 0; overflow-y: auto; max-height: calc(100vh - 327px);">
          <a href="window.location.href='#'" onclick="location.reload()"
            style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/trangchu.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Trang
            ch·ªß
          </a>
          <a href="hoadondt.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/index1.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> H√≥a ƒë∆°n
            ƒëi·ªán t·ª≠
          </a>
          <a href="/user/khaithue.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon5.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Khai thu·∫ø
          </a>
          <a href="/user/dangky.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon5.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> ƒêƒÉng k√Ω
            thu·∫ø
          </a>
          <a href="ho-tro-qtt.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon6.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> H·ªó tr·ª£
            quy·∫øt to√°n thu·∫ø TNCN
          </a>
          <a href="hoso.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon7.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tra c·ª©u
            h·ªì s∆° khai thu·∫ø
          </a>
          <a href="/user/nopthue.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon8.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Nh√≥m ch·ª©c
            nƒÉng n·ªôp thu·∫ø
          </a>
          <a href="/user/nghiavu.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon9.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tra c·ª©u
            nghƒ©a v·ª• thu·∫ø
          </a>
          <a href="/user/thongbao.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon10.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tra c·ª©u
            th√¥ng b√°o
          </a>
          <a href="/user/tienich.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon11.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Ti·ªán √≠ch
          </a>
          <a href="hotro.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon12.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> H·ªó tr·ª£
          </a>
          <a href="/user/thietlap.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon13.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Thi·∫øt
            l·∫≠p c√° nh√¢n
          </a>
          <a href="#" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/icon-doimk.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> ƒê·ªïi
            m·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p
          </a>
          <a href="#" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="assets/faceid.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> ƒêƒÉng
            nh·∫≠p b·∫±ng v√¢n tay / FaceID
          </a>
          <div style="padding: 20px; border-top: 1px solid #f0f0f0; margin-top: 10px;">
            <button onclick="logout()" style="
            width: 100%;
            background: linear-gradient(135deg, #b71c1c, #d32f2f);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(183, 28, 28, 0.3);
            transition: transform 0.1s ease;
          " onmousedown="this.style.transform='scale(0.98)'" onmouseup="this.style.transform='scale(1)'">
              ƒêƒÉng xu·∫•t
            </button>
          </div>
        </div>
      </div>

      <div id="menuOverlay" class="menu-overlay" onclick="closeMenu()"></div>

      <!-- ‚úÖ HEADER - EXTENDED TO MST TEXT LEVEL -->
      <header class="topbar"
        style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000; height: 100px; margin: 0;">
        <div class="left-menu" onclick="openMenu()">‚ò∞</div>
        <div class="center-logo">
          <img src="assets/logo.png" alt="Logo" />
          <span>eTax Mobile</span>
        </div>
        <div class="right-icon">
          <img src="assets/icon-qr.png" alt="QR" class="icon-32" />
          <a href="/user/thongbao.html"><img src="assets/icon-bell.png" alt="Bell" class="icon-32" /></a>
        </div>
      </header>
      <div class="content-scrollable" style="padding-top: 70px; /* ‚úÖ SPACING ƒê√öNG NH∆Ø BACKUP */">
        <div class="unified-viewport"
          style="height: calc(100vh - 100px); overflow: hidden; background: transparent; max-width: 420px; margin: 0 auto;">
          <div class="scrollable-content"
            style="height: 100%; overflow-y: auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; padding-right: 10px;">
            <section class="user-info"
              style="width: calc(100vw - 20px); max-width: 420px; border-radius: 16px; background-color: #ffffff; display: flex; align-items: center; padding: 8px 12px; margin: 6px auto; min-height: 120px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">

              <img class="avatar" src="assets/avatar.png" alt="Avatar" style="width: 80px; height: 80px;" />
              <div class="userinfo-text" style="margin-left: 2px; flex-grow: 1;">
                <div class="mst" style="color: black; font-size: 18px; font-weight: 400;" id="user-mst">MST: ...</div>
                <div class="username"
                  style="display: flex; align-items: center; gap: 8px; white-space: nowrap; font-size: 20px; font-weight: 500; color: #5B0000; text-transform: uppercase;">
                  <span id="user-name">(Ch∆∞a ƒëƒÉng nh·∫≠p)</span><a href="/user/thongtin.html"><img src="assets/nutha.png"
                      alt="Th√¥ng tin" style="width: 20px; height: 20px; margin-left: 5px;"></a>
                </div>
              </div>
            </section>

            <section
              style="background-color: #ffffff; min-height: 220px; border-radius: 16px; width: calc(100vw - 20px); max-width: 420px; margin: 6px auto; position: relative; overflow: hidden; padding: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <h3 style="color: black; margin: 0; font-size: 20px; font-weight: normal;">&nbsp;&nbsp;Ch·ª©c nƒÉng hay
                  d√πng</h3>
                <img src="assets/2gach.png" alt="c√†i ƒë·∫∑t" style="width: 30px; height: 20px; margin-right: 10px;" />
              </div>

              <button onclick="scrollLeft()"
                style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); background: none; border: none; z-index: 10;">
                <img src="assets/arrow-left.png" style="width: 30px;" />
              </button>

              <button onclick="scrollRight()"
                style="position: absolute; right: 0; top: 50%; transform: translateY(-50%); background: none; border: none; z-index: 10;">
                <img src="assets/arrow-right.png" style="width: 30px;" />
              </button>

              <div id="scrollable"
                style="display: flex; overflow-x: auto; overflow-y: hidden; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; scrollbar-width: none; -ms-overflow-style: none; gap: 15px; padding: 5px 20px 8px 20px; height: 180px; align-items: flex-start; touch-action: pan-x; position: relative; z-index: 1;">
                <div style="text-align: center; min-width: 90px; flex-shrink: 0; cursor: pointer; padding: 4px;"
                  onclick="javascript:location.href='tracuttnpt.html';">
                  <img src="assets/icon1.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
                  <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Tra
                    c·ª©u<br>th√¥ng tin<br>ng∆∞·ªùi ph·ª•<br>thu·ªôc</span>
                </div>
                <div style="text-align: center; min-width: 90px; flex-shrink: 0; cursor: pointer; padding: 4px;"
                  onclick="javascript:location.href='hsdkythue.html';">
                  <img src="assets/icon2.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
                  <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">H·ªì
                    s∆°<br>ƒëƒÉng k√Ω<br>thu·∫ø</span>
                </div>
                <div style="text-align: center; min-width: 90px; flex-shrink: 0; padding: 4px;">
                  <img src="assets/icon3.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
                  <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">H·ªì
                    s∆°<br>quy·∫øt<br>to√°n thu·∫ø</span>
                </div>
                <div style="text-align: center; min-width: 90px; flex-shrink: 0; padding: 4px;">
                  <img src="assets/icon4.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
                  <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Tra
                    c·ª©u<br>th√¥ng tin<br>quy·∫øt<br>to√°n</span>
                </div>
                <div style="text-align: center; min-width: 90px; flex-shrink: 0; cursor: pointer; padding: 4px;"
                  onclick="javascript:location.href='tra-cuu-chung-tu.html';">
                  <img src="assets/icon4.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
                  <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Tra
                    c·ª©u<br>ch·ª©ng t·ª´<br>thu·∫ø</span>
                </div>
              </div>
            </section>

            <section
              style="background: #ffffff; padding: 15px; width: calc(100vw - 20px); max-width: 420px; margin: 6px auto 0 auto; font-family: sans-serif; border-radius: 14px; min-height: 320px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); flex-grow: 1;">
              <h3 style="margin-bottom: 16px; font-size: 18px; color: black;">Danh s√°ch nh√≥m d·ªãch v·ª•</h3>
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; padding: 15px 5px 20px 5px;">
                <div onclick="window.location.href='/user/hoadondt.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index1.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Ho√° ƒë∆°n
                    ƒëi·ªán<br>t·ª≠</span>
                </div>
                <div onclick="window.location.href='/user/khaithue.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index2.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Khai thu·∫ø</span>
                </div>
                <div onclick="window.location.href='/user/dangky.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index3.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">ƒêƒÉng k√Ω thu·∫ø</span>
                </div>
                <div onclick="window.location.href='/user/ho-tro-qtt.html'"
                  style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index4.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">H·ªó tr·ª£ quy·∫øt to√°n
                    thu·∫ø<br>TNCN</span>
                </div>
                <div onclick="window.location.href='/user/nopthue.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index5.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Nh√≥m ch·ª©c<br>nƒÉng
                    n·ªôp<br>thu·∫ø</span>
                </div>
                <div onclick="window.location.href='/user/nghiavu.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index6.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Tra c·ª©u nghƒ©a<br>v·ª•
                    thu·∫ø</span>
                </div>
                <div onclick="window.location.href='/user/thongbao.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index7.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Tra c·ª©u
                    th√¥ng<br>b√°o</span>
                </div>
                <div onclick="window.location.href='/user/tienich.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index8.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Ti·ªán √≠ch</span>
                </div>
                <div onclick="window.location.href='/user/hotro.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index9.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">H·ªó tr·ª£</span>
                </div>
                <div onclick="window.location.href='/user/thietlap.html'" style="text-align: center; cursor: pointer;">
                  <div
                    style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
                    <img src="assets/index10.png" style="width: 55px; height: 55px;" />
                  </div>
                  <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Thi·∫øt l·∫≠p c√°
                    nh√¢n</span>
                </div>
              </div>
            </section>


          </div>
        </div>
      </div>
    </div>

    <script>
      // QUAN TR·ªåNG: Disable device_auth_manager cho index.html
      window.DISABLE_DEVICE_AUTH_MANAGER = true;

      // üîß FIX: Force clear cache v√† disable conflicting scripts
      if ('caches' in window) {
        caches.keys().then(names => {
          names.forEach(name => {
            caches.delete(name);
          });
        });
      }

      console.log('=== SIMPLE INDEX.HTML LOADED ===');

      // üîß SIMPLE AUTH CHECK: Ch·ªâ ki·ªÉm tra user ƒë√£ login ch∆∞a
      const loggedInUser = localStorage.getItem('etax_logged_in_user');

      console.log('üîç Simple auth check:', {
        loggedInUser: loggedInUser
      });

      if (!loggedInUser) {
        console.log('‚ùå No user logged in - redirecting to login');
        window.location.href = '/login.html';
      } else {
        console.log('‚úÖ User logged in - staying on index.html');
      }

      // Th√™m timestamp ƒë·ªÉ tr√°nh cache khi reload trang
      window.addEventListener('pageshow', function (event) {
        if (event.persisted) {
          // Trang ƒë∆∞·ª£c restore t·ª´ cache, th√™m timestamp ƒë·ªÉ force reload
          const currentUrl = window.location.href;
          const separator = currentUrl.includes('?') ? '&' : '?';
          window.location.href = currentUrl + separator + '_t=' + Date.now();
        }
      });

      // üí° T·ªëi ∆∞u h√≥a: C·∫•u h√¨nh Firebase ƒë√£ ƒë∆∞·ª£c chuy·ªÉn v√†o js/firebase-config.js
      let user = JSON.parse(localStorage.getItem("etax_user_info") || "{}"); // Bi·∫øn user to√†n c·ª•c

      // ‚úÖ NESTED SCROLL SOLUTION - Vertical + Horizontal smooth
      document.addEventListener('DOMContentLoaded', function () {
        // Initialize Theme and UI Manager
        initializeThemeSystem();

        // iPhone 11 compatibility fixes
        document.body.style.webkitTransform = 'none';
        document.body.style.transform = 'none';
        document.documentElement.style.webkitTransform = 'none';
        document.documentElement.style.transform = 'none';

        // Nested scroll implementation
        const scrollableDiv = document.getElementById('scrollable');
        const mainContainer = document.querySelector('.scrollable-content');

        if (scrollableDiv && mainContainer) {
          let startX = 0, startY = 0, scrollIntent = null;

          scrollableDiv.addEventListener('touchstart', function (e) {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
            scrollIntent = null;
          }, { passive: true });

          scrollableDiv.addEventListener('touchmove', function (e) {
            const currentX = e.touches[0].clientX;
            const currentY = e.touches[0].clientY;
            const diffX = Math.abs(currentX - startX);
            const diffY = Math.abs(currentY - startY);

            // Detect scroll intent
            if (!scrollIntent && (diffX > 10 || diffY > 10)) {
              scrollIntent = diffX > diffY ? 'horizontal' : 'vertical';
            }

            // Route scroll based on intent
            if (scrollIntent === 'vertical') {
              // Allow parent vertical scroll
              scrollableDiv.style.overflowX = 'hidden';
            } else if (scrollIntent === 'horizontal') {
              // Allow horizontal scroll, prevent vertical
              e.stopPropagation();
              scrollableDiv.style.overflowX = 'auto';
            }
          }, { passive: false });

          scrollableDiv.addEventListener('touchend', function () {
            // Reset
            setTimeout(() => {
              scrollableDiv.style.overflowX = 'auto';
            }, 100);
          }, { passive: true });
        }
      });

      // Functions ƒëi·ªÅu h∆∞·ªõng
      function openMenu() {
        document.getElementById("slideMenu").classList.add("open");
        document.getElementById("menuOverlay").classList.add("show");
        document.getElementById("slide-username").innerText = user.name || "...";
      }

      function closeMenu() {
        document.getElementById("slideMenu").classList.remove("open");
        document.getElementById("menuOverlay").classList.remove("show");
      }

      function logout() {
        // Clear session
        localStorage.removeItem('etax_logged_in_user');
        localStorage.removeItem('etax_user_info');

        // Redirect to login
        window.location.href = '/login.html';
      }

      // Function chuy·ªÉn trang tra c·ª©u ch·ª©ng t·ª´
      function navigateToChungTu() {
        console.log('Navigating to tra-cuu-chung-tu.html');
        window.location.href = 'tra-cuu-chung-tu.html';
      }

      // Functions cu·ªôn ngang
      const scrollable = document.getElementById("scrollable");

      function scrollLeft() {
        scrollable.scrollBy({ left: -140, behavior: 'smooth' });
      }

      function scrollRight() {
        scrollable.scrollBy({ left: 140, behavior: 'smooth' });
      }

      // Kh·ªüi t·∫°o khi trang load
      window.onload = function () {
        initializePage();
      }

      // Kh·ªüi t·∫°o l·∫°i khi trang ƒë∆∞·ª£c hi·ªÉn th·ªã (bao g·ªìm c·∫£ khi back t·ª´ trang kh√°c)
      window.addEventListener('pageshow', function (event) {
        initializePage();
      });

      // Function kh·ªüi t·∫°o trang
      function initializePage() {
        user = JSON.parse(localStorage.getItem("etax_user_info") || "{}");

        // Default user info as per requirement
        const defaultUserName = "Nguy·ªÖn Trung Nghƒ©a";
        const defaultMST = "001095026798";

        // Update with default values if not present
        if (!user.name || user.name === "(Ch∆∞a ƒëƒÉng nh·∫≠p)") {
          user.name = defaultUserName;
          user.mst = user.mst || defaultMST;
          localStorage.setItem("etax_user_info", JSON.stringify(user));
        }

        document.getElementById("user-mst").innerText = "MST: " + (user.mst || defaultMST);
        document.getElementById("user-name").innerText = (user.name || defaultUserName).toUpperCase();

        if (document.getElementById("slide-username")) {
          document.getElementById("slide-username").innerText = user.name || defaultUserName;
        }

        // ƒê·∫£m b·∫£o event listeners ƒë∆∞·ª£c kh·ªüi t·∫°o l·∫°i
        setupEventListeners();
      }

      // Function thi·∫øt l·∫≠p event listeners
      function setupEventListeners() {
        const scrollable = document.getElementById("scrollable");

        // X√≥a event listeners c≈© tr∆∞·ªõc khi th√™m m·ªõi (tr√°nh tr√πng l·∫∑p)
        scrollable.removeEventListener('touchstart', handleTouchStart);
        scrollable.removeEventListener('touchmove', handleTouchMove);
        scrollable.removeEventListener('touchend', handleTouchEnd);
        scrollable.removeEventListener('mousedown', handleMouseDown);
        scrollable.removeEventListener('mouseleave', handleMouseLeave);
        scrollable.removeEventListener('mouseup', handleMouseUp);
        scrollable.removeEventListener('mousemove', handleMouseMove);

        // Th√™m event listeners m·ªõi - CH·ªà CHO SCROLL NGANG
        scrollable.addEventListener('touchstart', handleTouchStart, { passive: true });
        scrollable.addEventListener('touchmove', handleTouchMove, { passive: true });
        scrollable.addEventListener('touchend', handleTouchEnd, { passive: true });
        scrollable.addEventListener('mousedown', handleMouseDown);
        scrollable.addEventListener('mouseleave', handleMouseLeave);
        scrollable.addEventListener('mouseup', handleMouseUp);
        scrollable.addEventListener('mousemove', handleMouseMove);
      }

      // Touch swipe event handlers - CHO PH√âP C·∫¢ SCROLL D·ªåC V√Ä NGANG
      let startXTouch, startYTouch, scrollIntent;

      function handleTouchStart(e) {
        startXTouch = e.touches[0].clientX;
        startYTouch = e.touches[0].clientY;
        scrollIntent = null;
        scrollable.style.scrollBehavior = 'auto';
      }

      function handleTouchMove(e) {
        const currentX = e.touches[0].clientX;
        const currentY = e.touches[0].clientY;
        const deltaX = Math.abs(currentX - startXTouch);
        const deltaY = Math.abs(currentY - startYTouch);

        // X√°c ƒë·ªãnh h∆∞·ªõng scroll
        if (!scrollIntent && (deltaX > 15 || deltaY > 15)) {
          scrollIntent = deltaX > deltaY ? 'horizontal' : 'vertical';
        }

        // CH·ªà x·ª≠ l√Ω scroll ngang, KH√îNG ch·∫∑n scroll d·ªçc
        if (scrollIntent === 'horizontal') {
          let deltaMove = currentX - startXTouch;
          scrollable.scrollLeft -= deltaMove * 1.2;
          startXTouch = currentX;
        }
        // V·ªõi passive: true, kh√¥ng th·ªÉ preventDefault ‚Üí scroll d·ªçc t·ª± do
      }

      function handleTouchEnd(e) {
        scrollable.style.scrollBehavior = 'smooth';
        scrollIntent = null;
      }

      // Mouse drag event handlers
      let isDown = false;
      let startX, scrollLeftStart;

      function handleMouseDown(e) {
        isDown = true;
        scrollable.classList.add('active');
        startX = e.pageX - scrollable.offsetLeft;
        scrollLeftStart = scrollable.scrollLeft;
      }

      function handleMouseLeave() {
        isDown = false;
      }

      function handleMouseUp() {
        isDown = false;
      }

      function handleMouseMove(e) {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - scrollable.offsetLeft;
        const walk = (x - startX) * 1.2;
        scrollable.scrollLeft = scrollLeftStart - walk;
      }

      // ‚úÖ SIMPLE SIDEBAR SWIPE - CH·ªà CHO PH√âP M·ªû MENU
      let touchStartX = 0;

      document.addEventListener('touchstart', function (e) {
        touchStartX = e.touches[0].clientX;
      }, { passive: true });

      document.addEventListener('touchend', function (e) {
        const touchEndX = e.changedTouches[0].clientX;
        const deltaX = touchEndX - touchStartX;

        // ‚úÖ CH·ªà CHO PH√âP M·ªû SIDEBAR T·ª™ EDGE TR√ÅI
        if (touchStartX < 20 && deltaX > 80) {
          openMenu();
        }
      }, { passive: true });

    </script>
    <script src="src/services/auth-simple.js"></script>
  </body>

</html>
